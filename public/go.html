<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ë¬¸ì„œë¡œ ì´ë™ ì¤‘...</title>
  <script>
    window.onload = function () {
      const params = new URLSearchParams(window.location.search);
      const doc = params.get('doc');

      const redirectMap = {
        ë°œì£¼í™•ì¸í˜ì´ì§€: "https://docs.google.com/spreadsheets/d/1FAYigya47GJWfTm4yysQSY9WCTDV8b0Du_rYnAtYug0/edit",
        êµ¬ë§¤í˜ì´ì§€:       "https://sites.google.com/view/misslee-smart-pac/%EC%8A%A4%EB%A7%88%ED%8A%B8%EC%9B%8C%ED%81%AC-%EC%8B%9C%EC%8A%A4%ED%85%9C/%EA%B5%AC%EB%A7%A4%EC%9E%90%EC%9E%AC%EA%B4%80%EB%A6%AC?authuser=0",
        êµ¬ë§¤ìº˜ë¦°ë”:       "https://calendar.google.com/calendar/u/0?cid=dTM3dGF0ZzVrYWo3cTZlcnU2bTJvOXZyODBAZ3JvdXAuY2FsZW5kYXIuZ29vZ2xlLmNvbQ",
        ëŒ€ì‹œë³´ë“œ:         "https://docs.google.com/spreadsheets/d/1YMH0u-NRghspwapeczB-siQPs022f3H2EFVp7tPX31s/edit?usp=sharing",
        ì¹´ì¹´ì˜¤í† í°ë°œê¸‰:   "https://docs.google.com/spreadsheets/d/15RDzwxbuo2X3B95axNaU41rj0ZECxfpu4nySK9sjy60/edit?usp=sharing",
        ê³µêµ¬ê´€ë¦¬ì ê²€í‘œ: "https://sites.google.com/view/misslee-smart-pac/%EC%8A%A4%EB%A7%88%ED%8A%B8%EC%9B%8C%ED%81%AC-%EC%8B%9C%EC%8A%A4%ED%85%9C/%EC%84%A4%EB%B9%84%EA%B4%80%EB%A6%AC",
        ì˜¨ìŠµë„ì ê²€í‘œ: "https://docs.google.com/forms/d/e/1FAIpQLSfq-T-5e9rJ45thY8C-bQOa_BWCD8Qn1J633f10OKt_FxmhUw/viewform",
        ìƒì‚°ë©”ì¸í™”ë©´: "https://docs.google.com/spreadsheets/d/1jAcpu4xP3XbA9qSLXOjr3WoMys4YSKvHk_1M-0FH9Ds/edit?gid=2017400441#gid=2017400441",
        ë¯¸ì“°ë¦¬ì„œëª…ì•±: "https://misslee-signature-dashboard.vercel.app/dashboard"
      };

      let target = redirectMap[doc];
      if (!target) {
        document.body.innerHTML = "<h2>âŒ ë¬¸ì„œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</h2>";
        return;
      }

      // â”€â”€â”€ ìŠ¤í”„ë ˆë“œì‹œíŠ¸ ë”¥ë§í¬ â”€â”€â”€
      if (target.includes("docs.google.com/spreadsheets/d/")) {
        const match = target.match(/\/d\/([^\/]+)/);
        const sheetId = match && match[1];
        const webUrl = target;
        if (sheetId) {
          if (/Android/.test(navigator.userAgent)) {
            target =
              `intent://docs.google.com/spreadsheets/d/${sheetId}/edit` +
              `#Intent;scheme=https;package=com.google.android.apps.docs;` +
              `S.browser_fallback_url=${encodeURIComponent(webUrl)};end`;
          }
          else if (/iPhone|iPad|iPod/.test(navigator.userAgent)) {
            target = `googlesheets://docs.google.com/spreadsheets/d/${sheetId}/edit`;
          }
          else {
            target = webUrl;
          }
        }
      }

      // â”€â”€â”€ êµ¬ê¸€ ìº˜ë¦°ë” ë”¥ë§í¬ â”€â”€â”€
      else if (target.includes("calendar.google.com")) {
        const webUrl = target;
        // í”„ë¡œí† ì½œ ì œê±°
        const urlNoProto = webUrl.replace(/^https?:\/\//, "");
        if (/Android/.test(navigator.userAgent)) {
          // Android Intent: com.google.android.calendar íŒ¨í‚¤ì§€ë¡œ
          target =
            `intent://${urlNoProto}` +
            `#Intent;scheme=https;package=com.google.android.calendar;` +
            `S.browser_fallback_url=${encodeURIComponent(webUrl)};end`;
        }
        else if (/iPhone|iPad|iPod/.test(navigator.userAgent)) {
          // iOS: googlecalendar:// ìŠ¤í‚´ ì‚¬ìš©&#8203;:contentReference[oaicite:0]{index=0}
          target = `googlecalendar://${urlNoProto}`;
        }
        else {
          target = webUrl;
        }
      }

      // ë¯¸ì“°ë¦¬ì„œëª…ì•±ë§Œ ì¹´ì¹´ì˜¤í†¡ ì¸ì•± ë¸Œë¼ìš°ì €ì—ì„œ ì™¸ë¶€ ë¸Œë¼ìš°ì €ë¡œ ì—´ê¸°
      if (navigator.userAgent.includes('KAKAOTALK') && doc === 'ë¯¸ì“°ë¦¬ì„œëª…ì•±' && params.get('mobile') === '1') {
        const isIOS = /iPhone|iPad|iPod/.test(navigator.userAgent);
        const chromeUrl = isIOS ? `googlechrome://${target.replace('https://', '')}` : target;

        document.body.innerHTML = `
          <div style="text-align: center; padding: 50px 20px; font-family: Arial, sans-serif;">
            <h2>ğŸŒ ì™¸ë¶€ ë¸Œë¼ìš°ì €ì—ì„œ ì—´ê¸°</h2>
            <p>ë” ë‚˜ì€ ì‚¬ìš© í™˜ê²½ì„ ìœ„í•´ ì™¸ë¶€ ë¸Œë¼ìš°ì €ì—ì„œ ì—´ì–´ì£¼ì„¸ìš”</p>
            <br>
            ${isIOS ? `
              <a href="${chromeUrl}" style="
                background: #4285f4;
                color: white;
                padding: 12px 24px;
                text-decoration: none;
                border-radius: 5px;
                display: inline-block;
                font-weight: bold;
                margin: 5px;
              ">Chromeì—ì„œ ì—´ê¸°</a>
              <br>
              <a href="${target}" style="
                background: #007bff;
                color: white;
                padding: 12px 24px;
                text-decoration: none;
                border-radius: 5px;
                display: inline-block;
                font-weight: bold;
                margin: 5px;
              ">Safariì—ì„œ ì—´ê¸°</a>
            ` : `
              <a href="${target}" style="
                background: #007bff;
                color: white;
                padding: 12px 24px;
                text-decoration: none;
                border-radius: 5px;
                display: inline-block;
                font-weight: bold;
              ">í¬ë¡¬ì—ì„œ ì—´ê¸°</a>
            `}
            <br><br>
            <small style="color: #666;">
              ${isIOS ?
                'Chromeì´ ì„¤ì¹˜ë˜ì–´ ìˆì§€ ì•Šë‹¤ë©´ Safariì—ì„œ ì—´ê¸°ë¥¼ ì„ íƒí•˜ê±°ë‚˜<br>ìš°ì¸¡ ìƒë‹¨ ê³µìœ  ë²„íŠ¼ > Chromeì—ì„œ ì—´ê¸°ë¥¼ ì„ íƒí•˜ì„¸ìš”' :
                'ìš°ì¸¡ ìƒë‹¨ â‹¯ ë©”ë‰´ > ë‹¤ë¥¸ ì•±ì—ì„œ ì—´ê¸° ë˜ëŠ” ì™¸ë¶€ ë¸Œë¼ìš°ì €ì—ì„œ ì—´ê¸°ë¥¼ ì„ íƒí•˜ì„¸ìš”'
              }
            </small>
          </div>
        `;
        return;
      }

      // ìµœì¢… ë¦¬ë””ë ‰ì…˜
      window.location.replace(target);
    };
  </script>
</head>
<body>
  <p>ğŸ“„ ë¬¸ì„œë¡œ ì´ë™ ì¤‘ì…ë‹ˆë‹¤...</p>
</body>
</html>
